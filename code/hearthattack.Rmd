---
title: 'Tipologia y ciclo de vida de los datos: Heart Attack Analysis & Prediction dataset'
author: "Autores : Soulaiman el Hamri y Eloy Pérez"
date: "Enero 2023"
output: 
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Descripción del dataset

El dataset elejido es: <https://www.kaggle.com/datasets/rashikrahmanpritom/heart-attack-analysis-prediction-dataset>.

Es un juego de datos contiene la información de diferentes parámetros que se miden al realizar un análisis cardíaco. Los datos se han obtenido de personas de diferentes edades y sexo. La pregunta que pretende responder es la de si es possible predecir un ataque cardíaco, y así poder actuar a tiempo.

# 2. Integración y selección de los datos de interés a analizar

En este apartado vamos a explorar el conjunto de datos con el que vamos a trabajar y seleccionar los datos que nos serán útiles para estudiar.

El primer paso es cargar el dataset:

```{r echo=TRUE, message=FALSE, warning=FALSE}
# Cargamos el juego de datos heart.csv
path = './heart.csv'
heartAttackData <- read.csv(path)
```

A continuació verificamos la estructura del juego de datos. Vemos el número de columnas que tenemos y ejemplos del contenido de las filas.

```{r echo=TRUE, message=FALSE, warning=FALSE}

dim(heartAttackData)
str(heartAttackData)
head(heartAttackData)
```

Podemos ver en el data frame que tenemos 303 observaciones y un total de 14 variables. Por cada variable podemos ver su tipo y a continuación un pequeño subconjunto de datos como ejemplo. Hemos podido comprobar que las variables contenidas en el fichero y sus tipos se corresponden a las que se han cargado.

A continuación se explica el significado de cada variable:

+--------------+----------------------------------------------------------------------------------------------------------------------+
| **Variable** | Descripción                                                                                                          |
+==============+======================================================================================================================+
| **age**      | Edad del paciente.                                                                                                   |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **sex**      | Sexo del paciente.                                                                                                   |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **cp**       | Tipo de dolor en el pecho.                                                                                           |
|              |                                                                                                                      |
|              | -   Valor 1: angina típica.                                                                                          |
|              |                                                                                                                      |
|              | -   Valor 2: angina atípica.                                                                                         |
|              |                                                                                                                      |
|              | -   Valor 3: dolor no anginoso.                                                                                      |
|              |                                                                                                                      |
|              | -   Valor 4: asintomático.                                                                                           |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **trtbps**   | Presión arterial en reposo (en mm Hg)                                                                                |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **chol**     | Colestorol en mg/dl obtenido a través del sensor BMI                                                                 |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **fbs**      | (Azúcar en sangre en ayunas \> 120 mg/dl) (1 = verdadero; 0 = falso)                                                 |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **restecg**  | Resultados electrocardiográficos en reposo.                                                                          |
|              |                                                                                                                      |
|              | -   Valor 0: normal.                                                                                                 |
|              |                                                                                                                      |
|              | -   Valor 1: tener anomalías en la onda ST-T (inversiones de la onda T y/o elevación o depresión del ST \> 0,05 mV). |
|              |                                                                                                                      |
|              | -   Valor 2: mostrar hipertrofia ventricular izquierda probable o definitiva según los criterios de Estes.           |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **thalachh** | Frecuencia cardíaca máxima alcanzada.                                                                                |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **exng**     | Angina inducida por el ejercicio (1 = sí; 0 = no)                                                                    |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **oldpeak**  | Pico anterior                                                                                                        |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **slp**      | Pendiente                                                                                                            |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **caa**      | Número de vasos grandes (0-3)                                                                                        |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **thall**    | unknown                                                                                                              |
+--------------+----------------------------------------------------------------------------------------------------------------------+
| **output**   | Es el target.                                                                                                        |
|              |                                                                                                                      |
|              | -   0= menos posibilidades de ataque al corazón                                                                      |
|              |                                                                                                                      |
|              | -   1= más posibilidades de ataque al corazón                                                                        |
+--------------+----------------------------------------------------------------------------------------------------------------------+

Los hechos numéricos a estudiar serán los siguientes:

-   age, sex, cp, trtbps, chol, fbs, restecg, exng y output.

# 3. Limpieza de los datos

3.1. ¿Los datos contienen ceros o elementos vacíos? Gestiona cada uno de estos casos.

A continuación vamos a procesar los datos para elminar los que sean erróneaos o redundantes. También vamos a ver si podemos eliminar algunos atributos de los datos.

Primeramente, vamos a ver si hay valores vacíos o nulos:

```{r echo=TRUE, message=FALSE, warning=FALSE}
# Buscamos campos nulos y vacíos 
print("Valores nulos:")
colSums(is.na(heartAttackData))
print("Campos vacíos:")
colSums(heartAttackData == "")
```

Podemos ver que el dataset no contiene ningún campo nulo o vacío.

A continuación vamos a eliminar la variable thall, ya que se desconoce su significado y no va a ser relevante en el estudio que vamos a realizar.

```{r echo=TRUE, message=FALSE, warning=FALSE}

#Eliminamos la columna thall
heartAttackData$thall<- NULL
```

A continuación vamos a identificar y gestionar los valores extremos. Para detectar dichos valores extremos o *outliers,* se va a obtener los rangos de los valores maximos y minimos de cada variable y a continuación se va a representar los datos mediante graficos de cajas (*boxplots*).

Primero empezamos mirando el rango de valores maximos y minimos de cada variable:

```{r echo=TRUE, message=FALSE, warning=FALSE}

library(ggplot2)

range(heartAttackData$age)
range(heartAttackData$sex)
range(heartAttackData$cp)
range(heartAttackData$trtbps)
range(heartAttackData$chol)
range(heartAttackData$fbs)
range(heartAttackData$restecg)
range(heartAttackData$thalachh)
range(heartAttackData$exng)
range(heartAttackData$oldpeak)
range(heartAttackData$slp)
range(heartAttackData$caa)
range(heartAttackData$output)


```

La edad comprendida de los pacientes esta entre 29 y 77. Por lo tanto, no hay valores extremos.

Comprovando el rango vemos que la mayoria de los valores son variables categoricas: sex, cp, fbs,restecg, exng, slp, caa y output. Se ha comprovado que cada valor numérico de las anteriores variables tiene un significado categórico.

Ahora nos falta por ver si hay valores extremos en trtbps, chol, thalachh y oldpeak. En caso que hayan, se ha decidido eliminar las observaciones de dichos valores extremos.

```{r echo=TRUE, message=FALSE, warning=FALSE}
#trtbps
g_caja<-boxplot(heartAttackData$trtbps, col="#0c4c8a", frame.plot=F, horizontal = TRUE)

#Eliminamos outliers:
heartAttackData<-heartAttackData[!(heartAttackData$trtbps %in% g_caja$out),]
```

```{r echo=TRUE, message=FALSE, warning=FALSE}
#chol
g_caja<-boxplot(heartAttackData$chol, col="#0c4c8a", frame.plot=F, horizontal = TRUE)

#Eliminamos outliers:
heartAttackData<-heartAttackData[!(heartAttackData$chol %in% g_caja$out),]

```

```{r echo=TRUE, message=FALSE, warning=FALSE}
#thalachh
g_caja<-boxplot(heartAttackData$thalachh, col="#0c4c8a", frame.plot=F, horizontal = TRUE)

#Eliminamos outliers:
heartAttackData<-heartAttackData[!(heartAttackData$thalachh %in% g_caja$out),]

```

```{r echo=TRUE, message=FALSE, warning=FALSE}
#oldpeak
g_caja<-boxplot(heartAttackData$oldpeak, col="#0c4c8a", frame.plot=F,horizontal = TRUE)

#Eliminamos outliers:
heartAttackData<-heartAttackData[!(heartAttackData$oldpeak %in% g_caja$out),]
```

# 4. Análisis de los datos

4.1. Selección de los grupos de datos que se quieren analizar/comparar (p. ej., si se van a comparar grupos de datos, ¿cuáles son estos grupos y qué tipo de análisis se van a aplicar?)

4.2. Comprobación de la normalidad y homogeneidad de la varianza.

4.3. Aplicación de pruebas estadísticas para comparar los grupos de datos. En función de los datos y el objetivo del estudio, aplicar pruebas de contraste de hipótesis, correlaciones, regresiones, etc.

Aplicar al menos tres métodos de análisis diferentes.

# 5. Representación de los resultados a partir de tablas y gráficas

Este apartado se puede responder a lo largo de la práctica, sin necesidad de concentrar todas las representaciones en este punto de la práctica.

# 6. Resolución del problema

A partir de los resultados obtenidos, ¿cuáles son las conclusiones? ¿Los resultados permiten responder al problema?

# 7. Código

Hay que adjuntar el código, preferiblemente en R, con el que se ha realizado la limpieza, análisis y representación de los datos. Si lo preferís, también podéis trabajar en Python.

# 8. Vídeo

Realizar un breve vídeo explicativo de la práctica (máximo 10 minutos), donde ambos integrantes del equipo expliquen con sus propias palabras el desarrollo de la práctica, basándose en las preguntas del enunciado para justificar y explicar el código desarrollado. Este vídeo se deberá entregar a través de un enlace al Google Drive de la UOC ([https://drive.google.com/...),](https://drive.google.com/…),) junto con enlace al repositorio Git entregado.
